<?xml version="1.0" encoding="utf-8" ?>
<Queries>
  <Query name="Createdatabase">
    <SQL>
      <![CDATA[If not exists (SELECT name FROM master.sys.databases WHERE name = N'{1}')
      CREATE DATABASE [{1}]
      ON PRIMARY(NAME = [{1}], FILENAME ='{0}{1}.mdf',
      SIZE = 200MB, MAXSIZE = 1000MB, FILEGROWTH = 10%) 
      LOG ON (NAME = [{1}_Log], FILENAME = '{0}{1}.ldf', 
      SIZE = 1MB, MAXSIZE = 5MB, FILEGROWTH = 10%)]]>
    </SQL>
    <HANA>
      <![CDATA[
      CREATE SCHEMA {1};
    
      --{0}
       ]]>
    </HANA>
  </Query>
  
  <Query name="Create@CHANGES_OINM">
    <SQL>
      <![CDATA[ 
      
      CREATE TABLE "@CHANGES_OINM" ("Version" bigint not null
      , "ItemCode" nvarchar(50) null,
      "Warehouse" nvarchar (8)  NULL,
      "OnHand"  decimal(21,6)  NULL,
      "Price" decimal(21,6)  NULL,
      "Synced" int null
      )
]]>
    </SQL>
    <HANA>
      <![CDATA[
      
CREATE column TABLE  "@CHANGES_OINM" ("DocEntry" bigint  not null primary key generated by default as IDENTITY ,
      "Version" bigint NOT NULL,
      "ItemCode" nvarchar(50)  NULL
      ,"Warehouse" nvarchar (8)  NULL,
      "OnHand" decimal(21,6)  NULL,
      "Price" decimal(21,6)  NULL,

      "Synced" int null--1success,0failed
      );

      
      ]]>
    </HANA>
  </Query>

  <Query name="Create@View_A">
    <SQL>
      <![CDATA[ 
  create view  a as
  (select  max("TransNum" ) "Version"
  ,oinm."ItemCode"
  ,oinm."Warehouse"
  from "{0}".dbo.oinm 
   inner join "{0}".dbo.owhs on  owhs."WhsCode" =oinm."Warehouse"
  inner join "{0}".dbo.oitm on oitm."ItemCode"= oinm."ItemCode"
    group by oinm."ItemCode",oinm."Warehouse" 
 ); ]]>
    </SQL>
    <HANA>
      <![CDATA[
      
  create view  a as
  (select  max("TransNum" ) "Version"
  ,oinm."ItemCode"
  ,oinm."Warehouse"
  from "{0}".oinm 
   inner join "{0}".owhs on  owhs."WhsCode" = oinm."Warehouse"
  inner join "{0}".oitm on oitm."ItemCode"= oinm."ItemCode"
    group by oinm."ItemCode",oinm."Warehouse" 
order by max("TransNum" ));

      
      ]]>
    </HANA>
  </Query>
  <Query name="Countries">
    <SQL>
      <![CDATA[SELECT "Code","Name" FROM OCRY]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT "Code","Name" FROM OCRY]]>
    </HANA>
  </Query>
  <Query name="Create@AB_CTRK">
    <SQL>
      <![CDATA[If not exists (select name from sysobjects where name = '@AB_CTRK') 
      CREATE TABLE [dbo].[@AB_CTRK]([DocEntry][bigint] IDENTITY(1, 1) NOT NULL,
      [U_version][bigint] NOT NULL,
      [U_ObjType][nvarchar](30) NOT NULL,[U_Key][nvarchar](30) NOT NULL,[U_DateTime][datetime] NOT NULL,
      [U_TrType][nvarchar](1) NOT NULL,[U_KeyName][nvarchar](100) NOT NULL  ,
      [Synced] int null
      ,CONSTRAINT[PK_@AB_CTRK] 
    
      PRIMARY KEY CLUSTERED([DocEntry] ASC)WITH
      (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON[PRIMARY]) ON[PRIMARY]]]>
    </SQL>
    <HANA>
      <![CDATA[
      
CREATE column TABLE  "@AB_CTRK"("DocEntry" bigint  not null primary key generated by default as IDENTITY ,
      "U_version" bigint NOT NULL,
      "U_ObjType" nvarchar(30) NOT NULL
      ,"U_Key" nvarchar (30) NOT NULL,
      "U_DateTime" datetime  NOT NULL,
      "U_TrType" nvarchar(1) NOT NULL,
      "U_KeyName" nvarchar(100) NOT NULL,
      "Synced" int null--1success,0failed
    )]]>
    </HANA>
  </Query>
  <Query name="Create@ItemClass">
    <SQL>
      <![CDATA[If not exists (select name from sysobjects where name = '@ItemClass') 
      CREATE TABLE [dbo]."@ItemClass"([DocEntry][bigint] IDENTITY(1, 1) NOT NULL,
      [U_ItemType][nvarchar](100) NOT NULL,
      [U_Description][nvarchar](100) NOT NULL  
      ,CONSTRAINT[PK_@itemClass] 
    
      PRIMARY KEY CLUSTERED([DocEntry] ASC)WITH
      (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON[PRIMARY]) ON[PRIMARY]]]>
    </SQL>
    <HANA>
      <![CDATA[If not exists (select name from sysobjects where name = '@ItemClass') 
      CREATE TABLE [dbo]."@ItemClass"([DocEntry][bigint] IDENTITY(1, 1) NOT NULL,
      [U_ItemType][nvarchar](100) NOT NULL,
      [U_Description][nvarchar](100) NOT NULL  
      ,CONSTRAINT[PK_@itemClass] 
    
      PRIMARY KEY CLUSTERED([DocEntry] ASC)WITH
      (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON[PRIMARY]) ON[PRIMARY]]]>
    </HANA>
  </Query>
  <Query name="Create@AB_TRKOBJ">
    <SQL>
      <![CDATA[If not exists (select name from sysobjects where name = '@AB_TRKOBJ')
      CREATE TABLE [dbo]."@AB_TRKOBJ"(
      [DocEntry] [bigint] IDENTITY(1,1) NOT NULL
      ,[U_ObjType] [nvarchar](30) NULL
      ,[U_KeyName] [nvarchar](30) NULL
      ,[Active] [nvarchar](1) NULL
      ,[U_LastVersion] bigint Null
      ,[U_HTBL] [nvarchar](30) NULL
      ,[U_Where] [nvarchar](max) NULL,CONSTRAINT [PK_SAP.@AB_TRKOBJ] 
      PRIMARY KEY CLUSTERED ([DocEntry] ASC)WITH 
      (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]]]>
    </SQL>
    <HANA>
      <![CDATA[     
      CREATE column TABLE "@AB_TRKOBJ"
      (
      "DocEntry"  bigint  not null primary key generated by default as IDENTITY ,
      "U_ObjType" nvarchar(30) NULL
      ,"U_KeyName" nvarchar(30) NULL
      ,"Active" nvarchar(1) NULL,
      "U_LastVersion" bigint Null,
      "U_HTBL" nvarchar(30) NULL,
      "U_Version" bigint null
      ,"U_Where" nvarchar(5000) NULL) ]]>
    </HANA>
  </Query>
  <Query name="Create@Expiry">
    <SQL>
      <![CDATA[If not exists (select name from sysobjects where name = '@Expiry')CREATE TABLE [dbo].[@Expiry]([U_ExpDays] [bigint] NOT NULL) ON [PRIMARY]]]>
    </SQL>
    <HANA>
      <![CDATA[
CREATE column TABLE "@Expiry"("U_ExpDays" bigint NOT NULL)]]>
    </HANA>
  </Query>
  <Query name="Create.SP.GET_CHANGES">
    <SQL>
      <![CDATA[
       IF EXISTS ( SELECT * FROM   sysobjects  WHERE  id = object_id(N'[dbo].[GET_CHANGES]') and OBJECTPROPERTY(id, N'IsProcedure') = 1 )
      DROP PROCEDURE [dbo].[GET_CHANGES];
  GO
 CREATE procedure [dbo].[GET_CHANGES]
(
@VersionNumber bigint,
@ToVersionNumber bigint
)
as 

begin
SELECT  a.[DocEntry]
      ,a.[U_ObjType]
      ,[U_Key]
	  ,b.U_KeyName
	  ,b.U_HTBL 
      ,[U_DateTime]
	  ,a.[U_TrType]
  FROM [CHANGE_TRACKING].[dbo].[@AB_CTRK] a
  inner join [CHANGE_TRACKING].[dbo]."@AB_TRKOBJ" b
  on a.U_ObjType = b.U_ObjType 
  where a.DocEntry  > @VersionNumber and a.DocEntry <= @ToVersionNumber
  order by DocEntry
  end
  GO]]>
    </SQL>
    <HANA>
      <![CDATA[
      CREATE procedure  GET_CHANGES
(
in VersionNumber bigint,
in ToVersionNumber bigint
)
LANGUAGE SQLSCRIPT
as 

begin
SELECT  a."DocEntry"
      ,a."U_ObjType"
      ,"U_Key"
	  ,b."U_KeyName"
	  ,b."U_HTBL" 
      ,"U_DateTime"
	  ,a."U_TrType"
  FROM "{0}"."@AB_CTRK" a
  inner join "{0}"."@AB_TRKOBJ" b
  on a."U_ObjType" = b."U_ObjType" 
  where a."DocEntry"  > :VersionNumber and a."DocEntry" <= :ToVersionNumber
  order by "DocEntry";
  end]]>
    </HANA>
  </Query>
  <Query name="Create.SP.GET_CHANGES_OINM">
    <SQL>
      <![CDATA[
       IF EXISTS ( SELECT * FROM   sysobjects  WHERE  id = object_id(N'[dbo].[GET_CHANGES_OINM]') and OBJECTPROPERTY(id, N'IsProcedure') = 1 )
      DROP PROCEDURE [dbo].[GET_CHANGES_OINM];
  GO
 CREATE procedure [dbo].[GET_CHANGES_OINM]
(
@VersionNumber bigint,
@ToVersionNumber bigint
)
as 

begin
select  max("TransNum" ) "Version",oinm."ItemCode",oinm."Warehouse",oitw."OnHand",itm1."Price"
from "{0}".oinm inner join "{0}".oitw 
on oinm."ItemCode"  = oitw ."ItemCode" and oinm."Warehouse" = oitw."WhsCode"
inner join "{0}".owhs on  owhs."WhsCode" = oitw."WhsCode" 
left outer join "{0}".itm1 on itm1."ItemCode" = oitw."ItemCode" and itm1."PriceList"=owhs."U_pharmacy_id"

 group by oinm."ItemCode",oinm."Warehouse",oitw."OnHand",itm1."Price"
 having max("TransNum" )>@VersionNumber and max("TransNum" )<@ToVersionNumber 
order by max("TransNum" );
  end
  GO]]>
    </SQL>
    <HANA>
      <![CDATA[ CREATE procedure  GET_CHANGES_OINM
(
in VersionNumber bigint,
in ToVersionNumber bigint
)
LANGUAGE SQLSCRIPT
as 

begin

select * from    "@CHANGES_OINM"  
where "Version"   >:VersionNumber and "Version"<:ToVersionNumber
and "Synced" is null ;
  end]]>
    </HANA>
  </Query>
  <Query name="Create.SF.AB_VN">
    <SQL>
      <![CDATA[
       IF EXISTS ( SELECT * FROM sysobjects WHERE id = object_id(N'AB_VN')  AND xtype IN (N'FN', N'IF', N'TF'))
      DROP FUNCTION [dbo].[AB_VN];
  GO
CREATE function [dbo].[AB_VN]
()
returns bigint
as begin
declare @DocEntry bigint 
	select @DocEntry = max(a.DocEntry) from [@AB_CTRK] a
	if(@DocEntry is null)
	set @DocEntry = 0;
	return  @DocEntry
end]]>
    </SQL>
    <HANA>
      <![CDATA[
      --Run in 
     CREATE FUNCTION AB_VN()

RETURNS result decimal(15,2)

LANGUAGE SQLSCRIPT  

SQL SECURITY INVOKER AS

BEGIN

select ifnull(max(a."DocEntry"),0) into result from "@AB_CTRK" a;

END; 
]]>
    </HANA>
  </Query>
  <Query name="insertdefaultdata">
    <SQL>
      <![CDATA[
	   INSERT INTO [dbo]."@AB_TRKOBJ" ( U_ObjType,U_KeyName,Active,U_HTBL)
SELECT  '{0}','{1}','{2}','{3}'
WHERE NOT EXISTS (
    SELECT U_ObjType FROM [dbo]."@AB_TRKOBJ" WHERE U_ObjType ='{0}'
)
      ]]>
    </SQL>
    <HANA>
      <![CDATA[
 INSERT INTO "{4}"."@AB_TRKOBJ" ( "U_ObjType","U_KeyName","Active","U_HTBL")
values (  '{0}','{1}','{2}','{3}');]]>
    </HANA>
  </Query>

  <Query name="isValid">
    <SQL>
      <![CDATA[
	 
SELECT COUNT(*)   FROM "{1}".dbo."@AB_TRKOBJ" WHERE "U_ObjType"='{0}';
      ]]>
    </SQL>
    <HANA>
      <![CDATA[
 
SELECT COUNT(*)   FROM "{1}"."@AB_TRKOBJ" WHERE "U_ObjType"='{0}';
 ]]>
    </HANA>
  </Query>
  <Query name="getSP">
    <SQL>
      <![CDATA[ SELECT definition FROM sys.sql_modules WHERE [object_id] = OBJECT_ID('{0}') ]]>
    </SQL>
    <HANA>
      <![CDATA[ SELECT definition FROM sys.sql_modules WHERE [object_id] = OBJECT_ID('{0}') ]]>
    </HANA>
  </Query>
  <Query name="dropChangeTracking">
    <SQL>
      <![CDATA[ IF EXISTS ( SELECT * FROM   sysobjects  WHERE  id = object_id(N'[dbo].[ChangeTracking]') and OBJECTPROPERTY(id, N'IsProcedure') = 1 )
  BEGIN
      DROP PROCEDURE [dbo].[ChangeTracking]
  END ]]>
    </SQL>
    <HANA>
      <![CDATA[DROP PROCEDURE ChangeTracking;]]>
    </HANA>
  </Query>
  <!--exec ChangeTracking @object_type , @transaction_type ,	 @num_of_cols_in_key , @list_of_key_cols_tab_del , @list_of_cols_val_tab_del--> 
  <!--call ChangeTracking( @object_type , @transaction_type ,	 @num_of_cols_in_key , @list_of_key_cols_tab_del , @list_of_cols_val_tab_del)-->  
  <Query name="changeTracking">
    <SQL>
      <![CDATA[ 
       
CREATE proc [dbo].[ChangeTracking]

@object_type nvarchar(20),
@transaction_type as nvarchar(1),
@num_of_cols_in_key int,
@list_of_key_cols_tab_del nvarchar(255),
@list_of_cols_val_tab_del nvarchar(255)


AS
BEGIN
if(@object_type in( select U_ObjType from [{0}].dbo."@AB_TRKOBJ" where Active='Y' ) and @transaction_type in('A','U','L','C'))
begin
declare @version int 
select @version = isnull(max(ct.U_version ),0)+1 from [{0}].[dbo].[@AB_CTRK] ct where ct.U_ObjType = @object_type 
insert into [{0}].[dbo].[@AB_CTRK] (U_ObjType,U_Key,U_DateTime,U_TrType,U_KeyName,U_version)
values(@object_type,@list_of_cols_val_tab_del,GETDATE(),@transaction_type,@list_of_key_cols_tab_del,@version);
delete [{0}].[dbo].[@AB_CTRK] --a left outer join b on a.[U_ObjType] = b.[U_ObjType] 
where datediff(day,getdate(),U_DateTime) > (select U_ExpDays from [{0}].[dbo].[@Expiry]) ;
end
END ]]>
    </SQL>
    <HANA>
      <![CDATA[ 
CREATE PROCEDURE ChangeTracking
(
	in object_type nvarchar(20), 				-- SBO Object Type
	in transaction_type nchar(1),			-- [A]dd, [U]pdate, [D]elete, [C]ancel, C[L]ose
	in num_of_cols_in_key int,
	in list_of_key_cols_tab_del nvarchar(255),
	in list_of_cols_val_tab_del nvarchar(255)
)
LANGUAGE SQLSCRIPT
AS

 VI_ID_FOUND INT = 1; 
 version int ;
begin

select count(*) into VI_ID_FOUND from "{0}"."@AB_TRKOBJ" where "Active"='Y' and "U_ObjType" = :object_type;
IF :VI_ID_FOUND > 0  and (:transaction_type = 'A' or :transaction_type ='U'or :transaction_type ='L' or :transaction_type ='C') THEN 
 

select ifnull(max(ct."U_version" ),0)+1 into version 
from "{0}"."@AB_CTRK" ct where ct."U_ObjType" = :object_type ;

insert into "{0}"."@AB_CTRK" ("U_ObjType","U_Key","U_DateTime","U_TrType","U_KeyName","U_version")
values(:object_type,:list_of_cols_val_tab_del,current_date,:transaction_type,:list_of_key_cols_tab_del,:version);
delete from "{0}"."@AB_CTRK"
 where DAYS_BETWEEN(NOW(), "U_DateTime") > 100;

end if;
  
end ]]>
    </HANA>
  </Query>
  <Query name="Create@Log">
  <SQL>
    <![CDATA[If not exists (select name from sysobjects where name = '@Log')CREATE TABLE [dbo].[@Log](
	[DocEntry] [bigint] IDENTITY(1,1) NOT NULL,
	[U_version] [bigint],
	[U_ObjType] [nvarchar](30),
	[U_DateTime] [datetime] NOT NULL,
	[U_Error] [nvarchar](max) NOT NULL,
	[U_Direction] [nvarchar](30) NOT NULL,
	[U_XML] text ,
	[U_KEY] [nvarchar](30) ,
 CONSTRAINT [PK_@Log] PRIMARY KEY CLUSTERED 
(
	[DocEntry] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]]]>
  </SQL>
  <HANA>
    <![CDATA[
CREATE column TABLE "@Log"(
	"DocEntry" bigint  NOT NULL primary key generated by default as IDENTITY,
	"U_version" TEXT,
	"U_ObjType" nvarchar(30),
	"U_DateTime" datetime NOT NULL,
	"U_Error" nvarchar(5000) NOT NULL,
	"U_Direction" nvarchar(30) NOT NULL, 
	"U_KEY" nvarchar(30) , 
	"U_DocNum" nvarchar(30) ,
	"U_XML" TEXT )]]>
  </HANA>
</Query>

  <Query name="LogMatrix">
  <SQL>
    <![CDATA[
    SELECT DocEntry,U_version,U_ObjType,U_DateTime,U_Error,U_Direction,U_XML
  FROM [{2}].[dbo].[@Log]
  where U_DateTime>='{0}' and U_DateTime<='{1}']]>
  </SQL>
  <HANA>
    <![CDATA[  
    SELECT "DocEntry","U_version","U_ObjType","U_DateTime","U_Error","U_Direction","U_XML"
  FROM "{2}"."@Log"
  where cast ("U_DateTime" as date)>='{0}' and cast ("U_DateTime" as date)<='{1}']]>
  </HANA>
</Query>
  <Query name="getMinMax">
    <SQL>
      <![CDATA[
	        select MIN(IdNumber) mini,MAX(IdNumber) maxi from OPWZ
      ]]>
    </SQL>
    <HANA>
      <![CDATA[
          select MIN(IdNumber) mini,MAX(IdNumber) maxi from OPWZ
      ]]>
    </HANA>
  </Query>
  <Query name="createCommonDb">
    <SQL>
      <![CDATA[
	      if (SELECT count(name) FROM sys.databases WHERE name LIKE '%CommonDB%') = 0 
BEGIN 
 CREATE DATABASE [CommonDB]
END;

      ]]>
    </SQL>
    <HANA>
      <![CDATA[
         DO BEGIN 
DECLARE VI_ID_FOUND INT = 1;
SELECT count(*) INTO VI_ID_FOUND FROM schemas WHERE schema_name = 'CommonDB' ;
IF :VI_ID_FOUND = 0  THEN
 CREATE DATABASE CommonDB
END;

      ]]>
    </HANA>
  </Query>
  <Query name="createDBsTable">
    <SQL>
      <![CDATA[
	        if (SELECT count(name) FROM [CommonDB].dbo.sysobjects WHERE name = 'DBs') = 0 
BEGIN 
  CREATE TABLE [CommonDB].dbo.DBs (
  Id int NOT NULL IDENTITY(1,1) PRIMARY KEY,
  SERVERNAME nvarchar(MAX) NOT NULL,
  DBSERVERTYPE nvarchar(MAX) NOT NULL,
  LISCENSSERVER nvarchar(MAX) NOT NULL,
  DBNAME nvarchar(MAX) NOT NULL,
  DBUSERNAME nvarchar(MAX) NOT NULL,
  DBPASSWORD nvarchar(MAX) NOT NULL,
  USERNAME nvarchar(MAX) NOT NULL,
  PASSWORD nvarchar(MAX) NOT NULL,
  SLDServer nvarchar(Max),
  Active bit NOT NULL DEFAULT(0)
)
END;
      ]]>
    </SQL>
    <HANA>
      <![CDATA[
      CREATE column TABLE "CommonDB"."DBs" (
  Id bigint NOT NULL  PRIMARY KEY generated by default as IDENTITY,
  SERVERNAME nvarchar(254) NOT NULL,
  DBSERVERTYPE nvarchar(254) NOT NULL,
  LISCENSSERVER nvarchar(254) NOT NULL,
  DBNAME nvarchar(254) NOT NULL,
  DBUSERNAME nvarchar(254) NOT NULL,
  DBPASSWORD nvarchar(254) NOT NULL,
  USERNAME nvarchar(254) NOT NULL,
  PASSWORD nvarchar(254) NOT NULL,
  SLDServer nvarchar(254),
  Active int NOT NULL DEFAULT 0
);
      ]]>
    </HANA>
  </Query>
  <Query name="insertDbs">
    <SQL>
      <![CDATA[
	   IF(SELECT COUNT(DBNAME) FROM [CommonDB].[dbo].[DBs] WHERE DBNAME='{3}') = 0 
      BEGIN 
       INSERT INTO [CommonDB].[dbo].[DBs]([SERVERNAME],[DBSERVERTYPE],[LISCENSSERVER],[DBNAME],[DBUSERNAME],[DBPASSWORD],[USERNAME],[PASSWORD],[Active], [SLDServer])
           VALUES('{0}','{1}','{2}','{3}','{4}','{5}','{6}','{7}','{8}','{9}')
      END

      ELSE
      BEGIN 
       UPDATE [CommonDB].[dbo].[DBs]
         SET [SERVERNAME] = '{0}',[DBSERVERTYPE] = '{1}',[LISCENSSERVER] = '{2}',[DBNAME] = '{3}',[DBUSERNAME]='{4}',[DBPASSWORD] ='{5}',[USERNAME] = '{6}',[PASSWORD] = '{7}',[Active] ='{8}',[SLDServer]='{9}'
       WHERE DBNAME='{3}'
      END
      ]]>
    </SQL>
    <HANA>
      <![CDATA[
DO BEGIN 
DECLARE VI_ID_FOUND INT = 1; 
SELECT COUNT(*) into VI_ID_FOUND FROM "CommonDB"."DBs" WHERE "DBNAME"='{3}'  

IF :VI_ID_FOUND = 0  THEN 
      INSERT INTO "CommonDB"."DBs"("SERVERNAME","DBSERVERTYPE","LISCENSSERVER","DBNAME","DBUSERNAME","DBPASSWORD","USERNAME","PASSWORD","Active", "SLDServer")
      VALUES('{0}','{1}','{2}','{3}','{4}','{5}','{6}','{7}','{8}','{9}')
 ELSE
      UPDATE "CommonDB"."DBs"
      SET "SERVERNAME" = '{0}',"DBSERVERTYPE" = '{1}',"LISCENSSERVER" = '{2}',"DBNAME" = '{3}',"DBUSERNAME"='{4}',"DBPASSWORD" ='{5}',"USERNAME" = '{6}',"PASSWORD" = '{7}',"Active" ='{8}',"SLDServer"='{9}'
      WHERE "DBNAME"='{3}'
END if
END;
      ]]>
    </HANA>
  </Query>
  <Query name="maxCount">
    <SQL>
      <![CDATA[SELECT  Count (*) as  "num",Max ("Code") as  "Code" FROM  "@MAIL_SET"  T0 ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT Count (*) as "num",Max ("Code") as  "Code" FROM "@MAIL_SET"  T0 ]]>

    </HANA>
  </Query>

  <Query name="Query_01">
    <SQL>
      <![CDATA[select count( * ) from "{0}".dbo."@AB_TRKOBJ" where "U_ObjType" = {1} and "Active" = 'Y']]>
    </SQL>
    <HANA>
      <![CDATA[
      select count(*) from "{0}"."@AB_TRKOBJ" where "U_ObjType" = {1} and "Active" = 'Y';
    
      --{0}
       ]]>
    </HANA>
  </Query>
  <Query name="Query_03">
    <SQL>
      <![CDATA[select count(*) from "{0}".dbo."oivk" where isnull( "U_Sync" ,'N') = 'N' ]]>
    </SQL>
    <HANA>
      <![CDATA[
    select count(*) from "{0}".oivk where ifnull( "U_Sync" ,'N') = 'N';
       ]]>
    </HANA>
  </Query>
  <Query name="Query_04">
    <SQL>
      <![CDATA[  
      select
         oinm."TransNum  "Version"  ,
      oinm."ItemCode",
      oinm."Warehouse",
      '7' "company_id",
      
      ifnull(oivk ."U_Sync" ,'N') "U_Sync"
      from "{0}".oinm
      inner join "{0}".oivk on oivk."TransNum" = oinm."TransNum"
      inner join "{0}".owhs on owhs."WhsCode" = oinm."Warehouse"
      inner join "{0}".oitm on oitm."ItemCode"= oinm."ItemCode"
      where ifnull(oivk ."U_Sync" ,'N') = 'N'  and owhs."WhsCode"='2000'
      group by oinm."ItemCode",
      oinm."Warehouse",
      isnull(oivk ."U_Sync" ,'N')
       ]]>
    </SQL>
    <HANA>
      <![CDATA[    
   with  a as 
(
select
	STRING_AGG( oinm."TransNum",',' order by oinm."TransNum") "Version"  ,
	oinm."ItemCode",
	oinm."Warehouse",  
	'7' "company_id",
	ifnull(oivk ."U_Sync" ,'N') "U_Sync"
from "{0}".oinm  
inner join "{0}".oivk on oivk."TransNum" = oinm."TransNum"
inner join "{0}".owhs on owhs."WhsCode" = oinm."Warehouse"
inner join "{0}".oitm on oitm."ItemCode"= oinm."ItemCode"  
where ifnull(oivk ."U_Sync" ,'N') = 'N'  and owhs."WhsCode"='2000' --and  ifnull(oitm ."U_Sync" ,'N') = 'Y'
group by oinm."ItemCode",
	oinm."Warehouse",  
	ifnull(oivk ."U_Sync" ,'N') 
), a1 as (

select a."Version",a."ItemCode",a."Warehouse",sum(OITW."OnHand") "OnHand",itm1. "Price",a."company_id"  
 
from a 
INNER JOIN oitw ON OITW."WhsCode" = a."Warehouse" and OITW."ItemCode" = a."ItemCode"
left outer join itm1 on itm1."ItemCode"=a."ItemCode" and itm1."PriceList" = 1
where     "U_Sync" ='N' 
group by a."company_id",a."Version",a."ItemCode",a."Warehouse" ,itm1. "Price" 
)
, q1 as (
select  floor((ROW_NUMBER() OVER (partition by  a1."company_id" ORDER BY  a1."company_id" ))/100)"id", *  
 from   a1
)  
,q2 as
(
select "id","Version", concat('"company_id":',"company_id") "header" 
,concat(
concat(
concat(
concat(
concat(
concat('{{"SKU":"',"ItemCode")
,'","quantity":')
,"OnHand")
,',"price":')
,"Price")
,'}}') "detail"
from q1
) 
,q3 as (
select "id",STRING_AGG("Version",',') "Version", "header","detail"
from q2
GROUP BY "id","header","detail"
)
,q4 as (
select "id",STRING_AGG("Version",',') "versions",concat(concat( concat( concat('{{',"header" ),',"items":['),STRING_AGG("detail",',') ),']}}')"detail" from q3
GROUP BY "id","header"
)
select * from q4
       ]]>
    </HANA>
  </Query>
  <Query name="Query_05">
    <SQL>
      <![CDATA[ update {2}. "@AB_TRKOBJ" set "U_Version" = {0} where "U_ObjType" = '{1}']]>
    </SQL>
    <HANA>
      <![CDATA[
   update  "{2}"."@AB_TRKOBJ" set "U_Version" = {0} where "U_ObjType" = '{1}';
       ]]>
    </HANA>
  </Query>
  <Query name="Query_06">
    <SQL>
      <![CDATA[ insert into "{8}"."@Log" ("U_DateTime","U_Direction","U_Error","U_XML","U_ObjType","U_version","U_KEY","U_DocNum") values ('{0}','{1}','{2}','{3}','{4}','{5}',{6},{7});]]>
    </SQL>
    <HANA>
      <![CDATA[
  insert into "{8}"."@Log" ("U_DateTime","U_Direction","U_Error","U_XML","U_ObjType","U_version","U_KEY","U_DocNum") values ('{0}','{1}','{2}','{3}','{4}','{5}',{6},{7});
       ]]>
    </HANA>
  </Query>
   
  <Query name="Query_08">
    <SQL>
      <![CDATA[  

update "{1}".oivk
set "U_Sync"='F' where "TransNum" in ({0})  ]]>
    </SQL>
    <HANA>
      <![CDATA[
  
update "{1}".oivk
set "U_Sync"='F' where "TransNum" in ({0})   ]]>
    </HANA>
  </Query>
        
  <Query name="Query_09">
    <SQL>
      <![CDATA[  

update "{1}"."OIVK"
set "U_Sync"='Y' where "TransNum" in ({0})    ]]>
    </SQL>
    <HANA>
      <![CDATA[
  
update "{1}"."OIVK"
set "U_Sync"='Y' where "TransNum" in ({0})   ]]>
    </HANA>
  </Query>
 
  <Query name="Query_10">
    <SQL>
      <![CDATA[  
 with a as (
 select  * from "{0}".dbo."@AB_CTRK" where "U_ObjType" = '{1}' 
 )
 select * from a where isnull("Synced" ,0) = 0
 
 ]]>
    </SQL>
    <HANA>
      <![CDATA[
  
 with a as (
 select  * from "{0}"."@AB_CTRK" where "U_ObjType" = '{1}' 
 )
 select * from a where ifnull("Synced" ,0) = 0
 

]]>
    </HANA>
  </Query>

  <Query name="Query_11">
    <SQL>
      <![CDATA[   
select count(*) from  "{0}".dbo. "@AB_CTRK"
where  "Synced" is null and "U_ObjType" = '{1}'   ]]>
    </SQL>
    <HANA>
      <![CDATA[
  
select count(*) from  "{0}". "@AB_CTRK"
where  "Synced" is null and "U_ObjType" ='{1}' ;   ]]>
    </HANA>
  </Query>
  <Query name="Query_12">
    <SQL>
      <![CDATA[  
update "{1}".dbo."@AB_CTRK"
set "Synced"=1 where "DocEntry" in ({0})  ]]>
    </SQL>
    <HANA>
      <![CDATA[
  
update "{1}"."@AB_CTRK"
set "Synced"=1 where "DocEntry" in ({0})   ]]>
    </HANA>
  </Query>
  <Query name="Query_13">
    <SQL>
      <![CDATA[  
update "{1}".dbo."@AB_CTRK"
set "Synced"=0 where "DocEntry" in ({0})   ]]>
    </SQL>
    <HANA>
      <![CDATA[
  
update "{1}"."@AB_CTRK"
set "Synced"=0 where "DocEntry" in ({0})   ]]>
    </HANA>
  </Query>

 <Query name="Query_14">
    <SQL>
      <![CDATA[  
SELECT *  FROM  "@MAIL_SET" T0  WHERE T0."U_Success"='Y']]>
    </SQL>
    <HANA>
      <![CDATA[
SELECT *  FROM  "@MAIL_SET" T0  WHERE T0."U_Success"='Y'
  ]]>
    </HANA>
  </Query>
<Query name="Query_15">
    <SQL>
      <![CDATA[  
SELECT *  FROM "BPC_LIVE"."@MAIL_SET" T0  WHERE T0."U_Error"='Y']]>
    </SQL>
    <HANA>
      <![CDATA[
SELECT *  FROM "BPC_LIVE"."@MAIL_SET" T0  WHERE T0."U_Error"='Y'
  ]]>
    </HANA>
  </Query>
  <Query name="Query_16">
    <SQL>
      <![CDATA[  
SELECT   "DocEntry"
      ,"U_ObjType"
      ,"U_KeyName"
      ,"Active"
      ,"U_LastVersion"
      ,"U_HTBL"
      ,"U_Where"
  FROM "{0}".[dbo]."@AB_TRKOBJ" where "Active" = 'Y']]>
    </SQL>
    <HANA>
      <![CDATA[

SELECT   "DocEntry"
      ,"U_ObjType"
      ,"U_KeyName"
      ,"Active"
      ,"U_LastVersion"
      ,"U_HTBL"
      ,"U_Where"
  FROM "{0}"."@AB_TRKOBJ"  where "Active" = 'Y'
  ]]>
    </HANA>
  </Query>
  <Query name="Query_17">
    <SQL>
      <![CDATA[ 
  select "Series", "SeriesName","DfltSeries","IsManual" from  nnm1 inner join onnm on nnm1."ObjectCode" = onnm."ObjectCode" and NNM1."DocSubType" = onnm."DocSubType" where nnm1."Locked" = 'N' and nnm1."ObjectCode" = '{0}'{1}
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
  select "Series", "SeriesName","DfltSeries","IsManual"  from  nnm1 inner join onnm on nnm1."ObjectCode" = onnm."ObjectCode" and NNM1."DocSubType" = onnm."DocSubType" where nnm1."Locked" = 'N' and  nnm1."ObjectCode" = '{0}'{1}
  ]]>
    </HANA>
  </Query>
  
  <Query name="Query_18">
    <SQL>
      <![CDATA[
      SELECT T0."BeginStr", T0."NextNumber",  T0."NumSize" FROM  "NNM1" T0  INNER  JOIN "NNM3" T1  ON  T1."Series" = T0."Series"  AND  T1."ObjectCode" = T0."ObjectCode" AND  T1."DocSubType" = T0."DocSubType" AND  T0."Series" = '{0}' 
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
SELECT T0."BeginStr", T0."NextNumber",  T0."NumSize" FROM  "NNM1" T0  INNER  JOIN "NNM3" T1  ON  T1."Series" = T0."Series"  AND  T1."ObjectCode" = T0."ObjectCode" AND  T1."DocSubType" = T0."DocSubType" AND  T0."Series" = '{0}' 
]]>
    </HANA>
  </Query>
  <Query name="Query_19">
    <SQL>
      <![CDATA[ 
select distinct "Series","IsManual" from SBODemoIT.dbo.NNM1   ]]>
    </SQL>
    <HANA>
      <![CDATA[
select distinct "Series","IsManual" from SBODemoIT.dbo.NNM1  ]]>
    </HANA>
  </Query>
  <Query name="Query_20">
    <SQL>
      <![CDATA[ 
  SELECT  T2."GroupName",T2."GroupCode" FROM  OCRG T2 where T2."GroupType" = '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
  SELECT  T2."GroupName",T2."GroupCode" FROM  OCRG T2 where T2."GroupType" = '{0}'
  ]]>
    </HANA>
  </Query>

  <Query name="Query_21">
    <SQL>
      <![CDATA[ 
  SELECT "GroupCode" "Code","GroupName" "Name"  FROM OCRG T0 where "GroupType"= '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
 
  SELECT "GroupCode" "Code","GroupName" "Name"  FROM OCRG T0 where "GroupType"= '{0}']]>
    </HANA>
  </Query>
  <Query name="Query_22">
    <SQL>
      <![CDATA[ 
  SELECT Distinct T0."Code", "Name" FROM OUBR T0
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
 
  SELECT Distinct T0."Code", "Name" FROM OUBR T0]]>
    </HANA>
  </Query>
  <Query name="Query_23">
    <SQL>
      <![CDATA[ 
 SELECT Distinct T0."ItmsGrpCod",T0."ItmsGrpNam" FROM OITB T0
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
 
   SELECT Distinct T0."ItmsGrpCod",T0."ItmsGrpNam" FROM OITB T0]]>
    </HANA>
  </Query>
   <Query name="ChrtofAcc">
    <SQL>
      <![CDATA[ 
SELECT T0."AcctCode",T0."AcctName",concat( T4."AcctName",' > ',T3."AcctName",' > ',T2."AcctName",' > ',T1."AcctName",' > ',T0."AcctName") "AccountPath",T0."FatherNum",T0."Levels",T0."CurrTotal",T0."Postable"

FROM OACT T0
left outer join OACT T1 on T1."AcctCode" = T0."FatherNum"
left outer join OACT T2 on T2."AcctCode" = T1."FatherNum"
left outer join OACT T3 on T3."AcctCode" = T2."FatherNum"
left outer join OACT T4 on T4."AcctCode" = T3."FatherNum"
where T0."Postable" = 'Y'  and T0."AcctCode"='{0}'
ORDER BY T0."GroupMask", T0."GrpLine",T0."Levels"    ]]>
    </SQL>
    <HANA>
      <![CDATA[
SELECT T0."AcctCode",T0."AcctName",concat( T4."AcctName",' > ',T3."AcctName",' > ',T2."AcctName",' > ',T1."AcctName",' > ',T0."AcctName") "AccountPath",T0."FatherNum",T0."Levels",T0."CurrTotal",T0."Postable"

FROM OACT T0
left outer join OACT T1 on T1."AcctCode" = T0."FatherNum"
left outer join OACT T2 on T2."AcctCode" = T1."FatherNum"
left outer join OACT T3 on T3."AcctCode" = T2."FatherNum"
left outer join OACT T4 on T4."AcctCode" = T3."FatherNum"
where T0."Postable" = 'Y'  and T0."AcctCode"='{0}'
ORDER BY T0."GroupMask", T0."GrpLine",T0."Levels"   ]]>
    </HANA>
  </Query>

  <Query name="COAData">
    <SQL>
      <![CDATA[ 
      SELECT T0."AcctCode",T0."AcctName",concat( T4."AcctName",' > ',T3."AcctName",' > ',T2."AcctName",' > ',T1."AcctName",' > ',T0."AcctName") "AccountPath",T0."FatherNum",T0."Levels",T0."CurrTotal",T0."Postable"

FROM OACT T0
left outer join OACT T1 on T1."AcctCode" = T0."FatherNum"
left outer join OACT T2 on T2."AcctCode" = T1."FatherNum"
left outer join OACT T3 on T3."AcctCode" = T2."FatherNum"
left outer join OACT T4 on T4."AcctCode" = T3."FatherNum"
{2} {3} OFFSET {1} ROWS FETCH NEXT {0} ROWS ONLY 
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
      SELECT T0."AcctCode",T0."AcctName",concat( T4."AcctName",' > ',T3."AcctName",' > ',T2."AcctName",' > ',T1."AcctName",' > ',T0."AcctName") "AccountPath",T0."FatherNum",T0."Levels",T0."CurrTotal",T0."Postable"

FROM OACT T0
left outer join OACT T1 on T1."AcctCode" = T0."FatherNum"
left outer join OACT T2 on T2."AcctCode" = T1."FatherNum"
left outer join OACT T3 on T3."AcctCode" = T2."FatherNum"
left outer join OACT T4 on T4."AcctCode" = T3."FatherNum"
 {2} {3} limit {0} OFFSET {1}
 
  ]]>
    </HANA>
  </Query>
  <Query name="COAList">
    <SQL>
      <![CDATA[ 
        SELECT T0."AcctCode" FROM OACT T0 {2} {3} OFFSET {1} ROWS FETCH NEXT {0} ROWS ONLY 
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
          SELECT T0."AcctCode" FROM OACT  {2} {3} limit {0} OFFSET {1}
  ]]>
    </HANA>
  </Query>
  <Query name="COACount">
    <SQL>
      <![CDATA[ 
      SELECT T0."AcctCode" FROM OACT T0 {0} {1}
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
      SELECT T0."AcctCode" FROM OACT T0 {0} {1}
  ]]>
    </HANA>
  </Query>
    <Query name="ItemGroup">
    <SQL>
      <![CDATA[ 
      SELECT "GroupCode","GroupName","GroupType" FROM OCRG T0
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
      SELECT "GroupCode","GroupName","GroupType" FROM OCRG T0
   ]]>
    </HANA>
  </Query>
 <Query name="Query_24">
    <SQL>
      <![CDATA[ 
 SELECT DISTINCT T0."empID",T0."lastName",T0."firstName" FROM [OHEM] T0
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
 
  SELECT DISTINCT T0."empID",T0."lastName",T0."firstName" FROM "OHEM" T0]]>
    </HANA>
  </Query>
  <Query name="Query_26">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM [@OHEMTYPE] T0  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "@OHEMTYPE" T0  ]]>
    </HANA>
  </Query>
  <Query name="Query_27">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."WHSCODE",T0."WhsName" FROM [OWHS] T0  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."WHSCODE",T0."WhsName" FROM "OWHS" T0  ]]>
    </HANA>
  </Query>
  <Query name="Query_28">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."CntctCode",T0."Name" FROM [OCPR] T0 WHERE T0."CardCode"= '{0}'  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."CntctCode",T0."Name" FROM "OCPR" T0 WHERE T0."CardCode"= '{0}'  ]]>
    </HANA>
  </Query>
  <Query name="Query_29">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name",T0."U_Desc" FROM "@ITEMCLASS" T0 WHERE T0."U_Type"= '{0}'   ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name",T0."U_Desc" FROM "@ITEMCLASS" T0 WHERE T0."U_Type"= '{0}' ]]>
    </HANA>
  </Query>
  <Query name="Query_30">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM [@Branch] T0  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "@BRANCH" T0  ]]>
    </HANA>
  </Query>
  <Query name="Query_31">
    <SQL>
      <![CDATA[ 
 SELECT Distinct T0."ItmsGrpCod",T0."ItmsGrpNam" FROM OITB T0 where "ItmsGrpCod"= '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
 
   SELECT Distinct T0."ItmsGrpCod",T0."ItmsGrpNam" FROM "OITB" T0 where "ItmsGrpCod"= '{0}']]>
    </HANA>
  </Query>
  <Query name="Query_32">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "OCST" T0 WHERE T0."Country"='{0}' ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "OCST" T0 WHERE T0."Country"='{0}' ]]>
    </HANA>
  </Query>
    <Query name="Query_33">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."CurrCode",T0."CurrName" FROM "OCRN" T0  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."CurrCode",T0."CurrName" FROM "OCRN" T0  ]]>
    </HANA>
  </Query>

  <Query name="Query_34">
    <SQL>
      <![CDATA[ 
 SELECT Distinct T0."ItemName" FROM OITM T0 where "DocEntery"= '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
 
   SELECT Distinct T0."ItemName" FROM "OITM" T0 where "DocEntery"= '{0}']]>
    </HANA>
  </Query>
  <Query name="Query_35">
    <SQL>
      <![CDATA[SELECT Distinct T0."ItemCode" FROM OITM T0 where "DocEntery"= '{0}']]>
    </SQL>
    <HANA>
      <![CDATA[ SELECT Distinct T0."ItemCode" FROM "OITM" T0 where "DocEntery"= '{0}']]>
    </HANA>
  </Query>
  <Query name="Query_36">
    <SQL>
      <![CDATA[SELECT Distinct T0."Code", T0."U_AName",T0."U_ID"  FROM [OCRY] T0 Order By T0."U_ID" ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT Distinct T0."Code", T0."U_AName",T0."U_ID"  FROM "OCRY" T0 Order By T0."U_ID" ]]>
    </HANA>
  </Query>
  <Query name="Query_37">
    <SQL>
      <![CDATA[SELECT T1.* FROM {0} T0
INNER JOIN ATC1 T1 ON T0."AtcEntry"=T1."AbsEntry"
WHERE T1."AbsEntry"='{1}' ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT T1.* FROM {0} T0
INNER JOIN "ATC1" T1 ON T0."AtcEntry"=T1."AbsEntry"
WHERE T1."AbsEntry"='{1}']]>
    </HANA>
  </Query>
 <Query name="Query_38">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM [@PricePlan] T0 Where "U_OITMClassID"='{0}'  and "U_PricPlnTyp"='Price by Class'  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "@PricePlan" T0 Where "U_OITMClassID"='{0}'  and "U_PricPlnTyp"='Price by Class' ]]>
    </HANA>
 
  </Query>

  <Query name="Query_39">
    <SQL>
      <![CDATA[ 
 SELECT Distinct T0."Name",T0."U_Desc" FROM "@ItemClass" T0 where "Code"= '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
    SELECT Distinct T0."Name",T0."U_Desc" FROM "@ItemClass" T0 where "Code"= '{0}'
]]>
    </HANA>
  </Query>

  <Query name="Query_40">
    <SQL>
      <![CDATA[ 
 SELECT Distinct T0.ItmsGrpNam FROM OITB T0 where ItmsGrpCod= '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
    SELECT Distinct T0.ItmsGrpNam FROM "OITB" T0 where ItmsGrpCod= '{0}'
]]>
    </HANA>
  </Query>
 <Query name="Query_41">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "@ITEMSTATUS" T0  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "@ITEMSTATUS" T0  ]]>
    </HANA>
  </Query>
<Query name="Query_42">
    <SQL>
      <![CDATA[ 
 SELECT  T0."Name",T0."U_Dscription" FROM "@ITEMSTATUS" T0 where "Code"= '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
    SELECT  T0."Name",T0."U_Dscription" FROM "@ITEMSTATUS" T0 where "Code"= '{0}'
]]>
    </HANA>
  </Query>

<Query name="Query_43">
    <SQL>
      <![CDATA[ 
 SELECT T0."DocEntry",T0."U_Desc",T0."U_CardCode", T0."U_CardName",T0."U_Ocrdid",T1."U_Branch",T1."U_Description",
T1."U_ItemClass",T1."U_Discount",T1."U_OitmTypeId",T1."U_ItemCode",T1."U_ItemName",T1."U_TotalAmnt",T1."U_TotalTax"
FROM "@AB_CONTRACT" T0 
INNER JOIN "@AB_CONTRACT1" T1 ON T0."DocEntry"=T1."DocEntry"
WHERE T0."DocEntry"='{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
    SELECT T0."DocEntry",T0."U_Desc",T0."U_CardCode", T0."U_CardName",T0."U_Ocrdid",T1."U_Branch",T1."U_Description",
T1."U_ItemClass",T1."U_Discount",T1."U_OitmTypeId",T1."U_ItemCode",T1."U_ItemName",T1."U_TotalAmnt",T1."U_TotalTax"
FROM "@AB_CONTRACT" T0 
INNER JOIN "@AB_CONTRACT1" T1 ON T0."DocEntry"=T1."DocEntry"
WHERE T0."DocEntry"='{0}'
]]>
    </HANA>
  </Query>
<Query name="Query_44">
    <SQL>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM [@PricePlan] T0 Where "U_Oitmid"='{0}'  and "U_PricPlnTyp"='Price by Item'  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."Code",T0."Name" FROM "@PricePlan" T0 Where "U_Oitmid"='{0}'  and "U_PricPlnTyp"='Price by Item' ]]>
    </HANA>
  </Query>
<Query name="Query_45">
    <SQL>
      <![CDATA[SELECT DISTINCT T0.U_HourlyRate,T0.U_HourlyExtra,T0.U_DailyRate,T0.U_DailyExtra,T0.U_WeeklyRate,T0.U_WeeklyExtra,T0.U_MnthlyRt,T0.U_MnthlyExtra FROM [@PricePlan] T0 Where Code='{0}'  ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0.U_HourlyRate,T0.U_HourlyExtra,T0.U_DailyRate,T0.U_DailyExtra,T0.U_WeeklyRate,T0.U_WeeklyExtra,T0.U_MnthlyRt,T0.U_MnthlyExtra FROM "@PricePlan" T0 Where Code='{0}' ]]>
    </HANA>
  </Query>
 <Query name="Query_46">
    <SQL>
      <![CDATA[ 
 SELECT Distinct T0."Phone1" FROM OCRD T0 where "CardCode"= '{0}'
  ]]>
    </SQL>
    <HANA>
      <![CDATA[
   SELECT Distinct T0."Phone1" FROM "OCRD" T0 where "CardCode"= '{0}']]>
    </HANA>
  </Query>
  <Query name="Query_47">
    <SQL>
      <![CDATA[ SELECT DISTINCT T0."Code" ,CONCAT(CONCAT(T0."Code",' - '),T0."Name") AS "Name" FROM OVTG T0 ]]>
    </SQL>
    <HANA>
      <![CDATA[ SELECT DISTINCT T0."Code" ,CONCAT(CONCAT(T0."Code",' - '),T0."Name") AS "Name" FROM "OVTG" T0 ]]>
    </HANA>
  </Query>
  <Query name="Query_48">
    <SQL>
      <![CDATA[ SELECT T0."Rate" FROM OVTG T0 WHERE T0."Code"='{0}' ]]>
    </SQL>
    <HANA>
      <![CDATA[ SELECT T0."Rate" FROM "OVTG" T0 WHERE T0."Code"='{0}' ]]>
    </HANA>
  </Query>
  <Query name="Query_49">
    <SQL>
      <![CDATA[ SELECT DISTINCT T0."DocEntry",T0."U_AbsId",T0."U_CardCode",T0."U_CardName",T0."CreateDate",T0."U_TelNo",T1."Address",T1."City"
FROM "@AB_CONTRACT" T0 
INNER JOIN OCRD T1 ON T0."U_CardCode"=T1."CardCode"
WHERE T0."DocEntry" = '{0}'
 ]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT DISTINCT T0."DocEntry",T0."U_AbsId",T0."U_CardCode",T0."U_CardName",T0."CreateDate",T0."U_TelNo",T1."Address",T1."City"
FROM "@AB_CONTRACT" T0 
INNER JOIN "OCRD" T1 ON T0."U_CardCode"=T1."CardCode"
WHERE T0."DocEntry" = '{0}'
 ]]>
    </HANA>
  </Query>
  <Query name="Query_50">
    <SQL>
      <![CDATA[ SELECT DISTINCT T0."U_ItemCode",T0."U_ItemName",T0."U_ItemTypeName",T0."U_ItemClassName",T0."U_StrtDate",T0."U_EndDate" FROM "@AB_CONTRACT1" T0 WHERE T0."DocEntry"= '{0}' ]]>
    </SQL>
    <HANA>
      <![CDATA[ SELECT DISTINCT T0."U_ItemCode",T0."U_ItemName",T0."U_ItemTypeName",T0."U_ItemClassName",T0."U_StrtDate",T0."U_EndDate" FROM "@AB_CONTRACT1" T0 WHERE T0."DocEntry"= '{0}' ]]>
    </HANA>
  </Query>
  <Query name="Query_51">
    <SQL>
      <![CDATA[ SELECT   "Code", "Name"  FROM "OACS"]]>
    </SQL>
    <HANA>
      <![CDATA[  SELECT   "Code", "Name"  FROM "OACS"]]>
    </HANA>
  </Query>
	  <Query name="Query_52">
    <SQL>
      <![CDATA[SELECT T0."Code",T0."Name",T0."Rate" FROM OVTG T0 WHERE T0."Code" =  '{0}']]>
    </SQL>
    <HANA>
      <![CDATA[SELECT T0."Code",T0."Name",T0."Rate" FROM OVTG T0 WHERE T0."Code" =  '{0}' ]]>
    </HANA>
  </Query>
	  <Query name="Query_53">
    <SQL>
      <![CDATA[SELECT T0."DocEntry" FROM ODRF T0 WHERE T0."U_ApprovalGUID" =  '{0}']]>
    </SQL>
    <HANA>
      <![CDATA[SELECT T0."DocEntry" FROM ODRF T0 WHERE T0."U_ApprovalGUID" =  '{0}']]>
    </HANA>
  </Query>
 <Query name="ItemPrice">
    <SQL>
      <![CDATA[SELECT T0."ItemCode",T4."ECVatGroup",T4."GroupCode",T1."ItmsGrpCod",T4."Discount", T0."Price",T1."NumInBuy",T1."DfltWH",T3."UgpEntry",T3."UgpCode"
FROM ITM1 T0
INNER JOIN OITM T1 ON T0."ItemCode"=T1."ItemCode"
LEFT OUTER JOIN OPLN T2 ON T0."PriceList" = T2."ListNum"
LEFT OUTER JOIN OUGP T3 ON T3."UgpEntry" =T1."UgpEntry"
inner join ocrd t4 on t4."ListNum" = T2."ListNum"
--WHERE T2."ListNum" = '1'
WHERE T0."ItemCode" =  '{0}' and t4."CardCode" = '{1}'
]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT T0."ItemCode",T4."ECVatGroup",T4."GroupCode",T1."ItmsGrpCod",T4."Discount", T0."Price",T1."NumInBuy",T1."DfltWH",T3."UgpEntry",T3."UgpCode"
FROM ITM1 T0
INNER JOIN OITM T1 ON T0."ItemCode"=T1."ItemCode"
LEFT OUTER JOIN OPLN T2 ON T0."PriceList" = T2."ListNum"
LEFT OUTER JOIN OUGP T3 ON T3."UgpEntry" =T1."UgpEntry"
inner join ocrd t4 on t4."ListNum" = T2."ListNum"
--WHERE T2."ListNum" = '1'
WHERE T0."ItemCode" =  '{0}' and t4."CardCode" = '{1}']]>
    </HANA>
  </Query>
  <Query name="Discount">
    <SQL>
      <![CDATA[SELECT T0."Discount" FROM ocrd T0
WHERE T0."CardCode" =  '{0}']]>
    </SQL>
    <HANA>
      <![CDATA[SELECT T0."Discount" FROM ocrd T0
WHERE T0."CardCode" =  '{0}']]>
    </HANA>
  </Query>
  <Query name="Address">
    <SQL>
      <![CDATA[SELECT  T1."U_Address" FROM "@DELADD_H"  T0
INNER JOIN  "@DELADD_R" T1
ON T1."Code" = T0."Code" Where T0."U_CardCode" = '{0}'
]]>
    </SQL>
    <HANA>
      <![CDATA[SELECT  T1."U_Address" FROM "@DELADD_H"  T0
INNER JOIN "@DELADD_R" T1
ON T1."Code" = T0."Code" Where T0."U_CardCode" = '{0}']]>
    </HANA>
  </Query>
  <Query name="ReportPath">
    <SQL>
      <![CDATA[
                SELECT "ReportPath" FROM FileRouting WHERE "SLObjectType" ='{0}' AND  "CompanyDB" ='{1}'
     ]]>
    </SQL>
    <HANA>
      <![CDATA[
        SELECT "ReportPath"  FROM FileRouting WHERE "SLObjectType" ='{0}' AND  "CompanyDB" ='{1}'
     ]]>
    </HANA>
  </Query>
	<Query name="Query_54">
		<SQL>
			<![CDATA[
	           SELECT "ExportPath","ExportExtension" FROM FileRouting WHERE "SLObjectType" ='{0}' AND  "CompanyDB" ='{1}'
            ]]>
		</SQL>
		<HANA>
			<![CDATA[
             SELECT "ExportPath","ExportExtension"  FROM FileRouting WHERE "SLObjectType" ='{0}' AND  "CompanyDB" ='{1}'
         ]]>
		</HANA>
	</Query>
	<Query name="Query_55">
		<SQL>
			<![CDATA[
		    SELECT "ReportPath" FROM FileRouting WHERE "SLObjectType" ='{0}' AND  "CompanyDB" ='{1}'
             ]]>
		</SQL>
		<HANA>
			<![CDATA[
            SELECT "ReportPath"  FROM FileRouting WHERE "SLObjectType" ='{0}' AND  "CompanyDB" ='{1}'
             ]]>
		</HANA>
	</Query>
  <Query name="Query_56">
		<SQL>
			<![CDATA[
		        SELECT A1."Discount" from OEDG A0 Inner Join EDG1 A1 on A0."AbsEntry"=A1."AbsEntry" Where A0."ObjCode" ='{0}' And A1."ObjKey" ='{1}'
             ]]>
		</SQL>
		<HANA>
			<![CDATA[
            SELECT A1."Discount" from OEDG A0 Inner Join EDG1 A1 on A0."AbsEntry"=A1."AbsEntry" Where A0."ObjCode" ='{0}' And A1."ObjKey" ='{1}'
             ]]>
		</HANA>
	</Query>
  <Query name="Query_57">
		<SQL>
			<![CDATA[
		       Select A0."USERID" From OUSR A0 Where A0."USER_CODE" = '{0}' ]]>
		</SQL>
		<HANA>
			<![CDATA[
            Select A0."USERID" From OUSR A0 Where A0."USER_CODE" = '{0}' ]]>
		</HANA>
	</Query>
  <Query name="Query_58">
		<SQL>
			<![CDATA[
		       Select A0."CardCode",A0."CardName" From OCRD A0 Where A0."CardType" = 'C' ]]>
		</SQL>
		<HANA>
			<![CDATA[
             Select A0."CardCode",A0."CardName" From OCRD A0 Where A0."CardType" = 'C' ]]>
		</HANA>
	</Query>
    <Query name="Query_59">
		<SQL>
			<![CDATA[
		       SELECT T0."GroupNum",T1."PymntGroup" From OCRD T0 
Inner Join OCTG T1 On T0."GroupNum" = T1."GroupNum"
Where T0."CardCode" = '{0}' ]]>
		</SQL>
		<HANA>
			<![CDATA[
             SELECT T0."GroupNum",T1."PymntGroup" From OCRD T0 
Inner Join OCTG T1 On T0."GroupNum" = T1."GroupNum"
Where T0."CardCode" = '{0}' ]]>
		</HANA>
	</Query> 
  <Query name="Query_60">
		<SQL>
			<![CDATA[
		      select "SlpName" from OSLP where "SlpCode" = '{0}' ]]>
		</SQL>
		<HANA>
			<![CDATA[
            select "SlpName" from OSLP where "SlpCode" = '{0}']]>
		</HANA>
	</Query> 
  <Query name="Query_61">
		<SQL>
			<![CDATA[
		      select "CardName" from OCRD where "CardCode" = '{0}' ]]>
		</SQL>
		<HANA>
			<![CDATA[
          select "CardName" from OCRD where "CardCode" = '{0}']]>
		</HANA>
	</Query>
  <Query name="Query_62">
  	<SQL>
			<![CDATA[
		      select "CardCode","CardName" from OCRD where "CardType"='C' {0} order by "CardName" ]]>
		</SQL>
		<HANA>
		<![CDATA[
		      select "CardCode","CardName" from OCRD where "CardType"='C' {0} order by "CardName" ]]>
		</HANA>
  </Query>
</Queries>